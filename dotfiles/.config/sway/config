# Sway config — mirrors XMonad keybindings

set $mod Mod4
set $term alacritty
set $menu wofi --show drun

font pango:CommitMonoNerdFontMono 11

# Outputs managed by kanshi (handles hotplug and multi-monitor profiles)
exec_always sh -c 'pkill -x kanshi; kanshi'

# Gaps (matching XMonad spacing 5)
gaps inner 5
default_border pixel 2
default_floating_border pixel 2

# XWayland for X11 app compatibility
xwayland enable

# Wayland environment for portals and D-Bus
exec --no-startup-id dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP=sway

# Autostart
exec_always sh -c 'pgrep -x copyq || copyq &'
exec mako
exec_always sh -c 'pgrep -x nm-applet || nm-applet --indicator &'
exec_always sh -c 'pgrep -x pasystray || pasystray &'

# Auto-lock after 5 min, screen off after 10 min
exec swayidle -w \
    timeout 300  'swaylock -f' \
    timeout 600  'swaymsg "output * dpms off"' \
    resume       'swaymsg "output * dpms on"' \
    before-sleep 'swaylock -f'

# Input
input type:keyboard {
    xkb_rules evdev
    xkb_model pc105
    xkb_layout hu
}

input type:touchpad {
    tap enabled
    natural_scroll disabled
    dwt enabled
}

# Terminal (Mod+Shift+Return matches XMonad)
bindsym $mod+Shift+Return exec $term

# Kill focused window (Mod+Shift+c matches XMonad)
bindsym $mod+Shift+c kill

# App launcher (Mod+p matches XMonad)
bindsym $mod+p exec $menu

# Reload sway config (Mod+q matches XMonad restart)
bindsym $mod+q reload

# Exit sway (Mod+Shift+q matches XMonad quit)
bindsym $mod+Shift+q exec swaynag -t warning -m 'Exit sway?' -B 'Yes, exit' 'swaymsg exit'

# Focus monitor (matching XMonad Mod+w/e)
bindsym $mod+w focus output left
bindsym $mod+e focus output right

# Focus (vim-style + arrows)
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right
bindsym $mod+Left  focus left
bindsym $mod+Down  focus down
bindsym $mod+Up    focus up
bindsym $mod+Right focus right

# Move windows
bindsym $mod+Shift+h     move left
bindsym $mod+Shift+j     move down
bindsym $mod+Shift+k     move up
bindsym $mod+Shift+l     move right
bindsym $mod+Shift+Left  move left
bindsym $mod+Shift+Down  move down
bindsym $mod+Shift+Up    move up
bindsym $mod+Shift+Right move right

# Splits (set direction for next window)
bindsym $mod+b splith
bindsym $mod+v splitv
# Relayout existing container
bindsym $mod+Shift+b exec swaymsg layout splith
bindsym $mod+Shift+v exec swaymsg layout splitv

# Resize mode
mode "resize" {
    bindsym h resize shrink width  5 ppt
    bindsym j resize grow   height 5 ppt
    bindsym k resize shrink height 5 ppt
    bindsym l resize grow   width  5 ppt
    bindsym Left  resize shrink width  5 ppt
    bindsym Down  resize grow   height 5 ppt
    bindsym Up    resize shrink height 5 ppt
    bindsym Right resize grow   width  5 ppt
    bindsym Return mode "default"
    bindsym Escape mode "default"
    bindsym $mod+r mode "default"
}
bindsym $mod+r mode "resize"

# Cycle layouts (Mod+Space matches XMonad)
bindsym $mod+space layout toggle split tabbed

# Toggle floating (Mod+Shift+Space matches XMonad reset layout spirit)
bindsym $mod+Shift+space floating toggle

# Fullscreen (Mod+f — common addition)
bindsym $mod+f fullscreen toggle

# Workspaces
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+6 workspace number 6
bindsym $mod+7 workspace number 7
bindsym $mod+8 workspace number 8
bindsym $mod+9 workspace number 9

bindsym $mod+Shift+1 move container to workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4
bindsym $mod+Shift+5 move container to workspace number 5
bindsym $mod+Shift+6 move container to workspace number 6
bindsym $mod+Shift+7 move container to workspace number 7
bindsym $mod+Shift+8 move container to workspace number 8
bindsym $mod+Shift+9 move container to workspace number 9

# Lock and suspend (matching XMonad)
bindsym $mod+Shift+o exec swaylock
bindsym $mod+Shift+s exec systemctl suspend

# Screenshots (grim replaces scrot)
bindsym Print       exec mkdir -p "$HOME/Pictures" && grim "$HOME/Pictures/screenshot-$(date +%Y%m%d-%H%M%S).png"
bindsym Ctrl+Print  exec mkdir -p "$HOME/Pictures" && grim -g "$(slurp)" "$HOME/Pictures/screenshot-$(date +%Y%m%d-%H%M%S).png"

# Audio (same as XMonad)
bindsym XF86AudioMute        exec wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
bindsym XF86AudioLowerVolume exec wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
bindsym XF86AudioRaiseVolume exec wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%+

# Brightness (same as XMonad)
bindsym XF86MonBrightnessDown exec ~/.local/bin/brightness-control down
bindsym XF86MonBrightnessUp   exec ~/.local/bin/brightness-control up

# Window assignments (matching XMonad)
assign [class="Vncviewer"]     workspace 5
assign [class="Gimp"]          workspace 6
assign [class="Slack"]         workspace 7
assign [class="Google-chrome"] workspace 8
assign [app_id="firefox"]      workspace 8

# Status bar
bar {
    swaybar_command waybar
}
